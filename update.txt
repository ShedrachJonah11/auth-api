Improved test coverage for API
